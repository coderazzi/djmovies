{% load uquery_tags %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>UQuery</title>
    <link rel="icon" type="image/png" href="/static/favicon-192x192.png" sizes="192x192">

    <link rel="stylesheet" href="/static/bootstrap-3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/sweet-alert.css">
    <link rel="stylesheet" href="/static/movies.css">
    <link rel="stylesheet" href="/static/spinner-wait.css">    

    <script src="/static/jquery-2.1.3.min.js" type="text/javascript"></script>
    <script src="/static/bootstrap-3.3.1/js/bootstrap.min.js"></script>
    <script src="/static/jquery.timeago.js" type="text/javascript"></script>
    <script src="/static/sweet-alert.min.js" type="text/javascript"></script>
    <script src="/static/spinner-wait.js"></script>
    <script src="/static/uquery.js"></script>
</head>

<body data-module='query_list'>

    <div id="spinner-screen">
        <div id="spinner-container">
            <div class="sk-spinner sk-spinner-double-bounce">
                <div class="sk-double-bounce1"></div>
                <div class="sk-double-bounce2"></div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="add-query-modal" tabindex="-1" role="dialog" 
            aria-labelledby="add-query-modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                    <h4 class="modal-title">Add new query</h4>
                </div>
                <div class="modal-body">
                    <div class='container col-sm-12'>
                        <div class='row'>
                            <form action='/uquery/query' method="POST">
                            <div class="col-sm-9">
                                <input name='add-query' type="text" class="form-control">
                            </div>
                            <div class="col-sm-3">
                                <input class='btn btn-control btn-primary' type='submit' value='Add'>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer"></div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="requery-modal" tabindex="-1" role="dialog" 
            aria-labelledby="requery-modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                    <h4 class="modal-title">Requery all</h4>
                </div>
                <div class="modal-body" id='requery-placeholder'>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class='jumbotron'>
        <div class='container'>
            <div class='row'>
                <div class='col-sm-2'>
                    <a href='/'><img src='/static/uquery.png' class='header-main-icon'></a>
                </div>
                <div class='col-sm-4'>
                    <div class='col-sm-12 header-typo'>uquery</div>
                    <div class='row'>
                        <div class='col-sm-6 col-sm-offset-3 subheader-typo'>by coderazzi</div>
                    </div>
                </div>
                <div class='col-sm-2 col-sm-offset-4'>
                    <div class='row prepend-top'>
                        <input class="btn btn-primary col-sm-10 prepend-top" type="button" value="Requery all" id='requery-btn'/>
                    </div>
                    <div class='row'>
                        <input class="btn btn-primary col-sm-10 prepend-top" type="button" value="Add new query" id='add-query-btn'/>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class='container'>
        <div class='row'>
            {% if queries %}
            <table class='table table-striped' id='query-list'>
                {% for query in queries %}
                <tr data-query-id='{{query.id}}'>
                    <td class='query-title col-sm-5'><a href='/uquery/query/{{query.id}}'>{{query.title}}</a></td>
                    <td class='col-sm-1'>{{query.r_valid}} [{{query.r_all}}]</td>
                    <td class='col-sm-1'>
                        {% if query.completed %}
                            completed
                        {% endif %}
                    </td>
                    <td class='col-sm-3'>refreshed <span class='timeago' title='{% format_time query.last_check %}'></span></td>
                    <td class='col-sm-1'>
                        <button class="btn btn-sm btn-delete btn-default" type="submit"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
                <h1 class='col-sm-4 col-sm-offset-4'>There are no queries</h1>
            {% endif %}
        </div>

    </div>

</body>

</html>
